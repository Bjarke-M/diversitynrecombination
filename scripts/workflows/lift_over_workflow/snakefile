# Import the os module for working with file paths and directories
import os

# Read species names from the CSV file
import pandas as pd

# Load the CSV file into a DataFrame
#species_df = pd.read_csv("/home/bjarkemp/primatediversity/people/bjarkemp/diversitynrecombination/data/species_names.csv")

# Get a list of species names from the DataFrame
#species_names = species_df["Species Name"].tolist()
species_names = ['Daubentonia_madagascariensis','Saguinus_midas','Theropithecus_gelada','Chlorocebus_aethiops',
                 'Rhinopithecus_roxellana','Mandrillus_sphinx','Macaca_mulatta','Loris_tardigradus','Callithrix_jacchus',
                 'Pithecia_pithecia','Lemur_catta-Thomas','Gorilla_gorilla_gorilla','Aotus_nancymaae','Sapajus_apella',
                 'Carlito_syrichta','Pongo_abelii','Cercocebus_atys','Galago_moholi','Nomascus_leucogenys','Colobus_guereza',
                 'Cebus_albifrons','Cercopithecus_mitis','Pongo_pygmaeus','Pan_troglodytes','Erythrocebus_patas',
                 'Microcebus_murinus','Propithecus_coquereli','Atele_fusciceps','Otolemur_garnettii','Nycticebus_pygmaeus']

# Define the path where the species folders are located
species_path = "/home/bjarkemp/primatediversity/data/gVCF_jointCalling_17_05_2021"
# Rule for generating all targets based on species folders
rule all:
    input:
        expand("/home/bjarkemp/primatediversity/people/bjarkemp/diversitynrecombination/data/liftover/{species}/{species}_lifted.vcf", species=species_names)

# Rule for performing liftover for each species
rule liftover:
    input:
        chain_file="/home/bjarkemp/primatediversity/data/chain_files_15_03_2022/{species}_To_hg38.liftOver.gz",
        input_vcf=os.path.join(species_path, "{species}/{species}ConcatGtVar.g.vcf.gz"),
        reference_fasta="/home/bjarkemp/primatediversity/data/chain_files_15_03_2022/hg38/hg38.fasta"
    output:
        "/home/bjarkemp/primatediversity/people/bjarkemp/primatediversity/data/liftover/{species}/{species}_lifted.vcf"
    shell:
        """
        # Run CrossMap.py to perform liftover
        CrossMap.py vcf --chromid l --no-comp-alleles {input.chain_file} {input.input_vcf} {input.reference_fasta} {output}
        """